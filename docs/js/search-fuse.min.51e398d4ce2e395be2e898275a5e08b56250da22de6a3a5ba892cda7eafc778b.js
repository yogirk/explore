document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("fuse-search-input"),t=document.getElementById("fuse-search-results");let o=null;const i=e.dataset.baseUrl||"/",a=i+"index.json";e.disabled=!0,e.placeholder="Loading search...";const n=document.createElement("p");n.className="search-loading",n.textContent="Loading search index...",t.appendChild(n),fetch(a).then(e=>{if(!e.ok)throw new Error("HTTP "+e.status);return e.json()}).then(t=>{o=new Fuse(t,{keys:["title","content","tags","categories"],includeScore:!0,threshold:.3,minMatchCharLength:2}),n.parentNode&&n.parentNode.removeChild(n),e.disabled=!1,e.placeholder="Search for articles...",e.focus()}).catch(n=>{s();const o=document.createElement("p");o.className="search-error",o.textContent="Search is currently unavailable. Please try again later.",t.appendChild(o),e.disabled=!0,e.placeholder="Search unavailable",console.error("Failed to load search index:",n)}),e.addEventListener("input",()=>{const n=e.value;if(n.length<2){s();return}if(!o){s();const e=document.createElement("p");e.className="search-loading",e.textContent="Still loading...",t.appendChild(e);return}const i=o.search(n);r(i)});function s(){for(;t.firstChild;)t.removeChild(t.firstChild)}function r(e){if(s(),e.length===0){const e=document.createElement("p");e.textContent="No results found.",t.appendChild(e);return}e.forEach(({item:e})=>{const n=document.createElement("article");n.className="result-item";const s=document.createElement("h3");s.className="result-title";const o=document.createElement("a");o.href=e.uri,o.textContent=e.title,s.appendChild(o);const i=document.createElement("p");i.className="result-snippet",i.textContent=e.content.substring(0,150)+"...",n.appendChild(s),n.appendChild(i),t.appendChild(n)})}})